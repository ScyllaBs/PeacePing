<!DOCTYPE html>
<html>
<head>
  <title>CalmPing</title>
  <style>
    body { font-family: Arial; max-width: 600px; margin: 20px auto; }
    input, button { padding: 8px; margin: 5px 0; width: 100%; }
    ul { padding-left: 20px; }
  </style>
</head>
<body>
  <h1>CalmPing</h1>

  <form action="/add" method="POST">
    <input type="text" name="message" placeholder="Message" required>
    <input type="datetime-local" name="date" required>
    <button type="submit">Programmer le message</button>
  </form>

  <h2>Messages programm√©s :</h2>
  <ul id="messagesList"></ul>

  <script>
    async function loadMessages() {
      const res = await fetch('/messages');
      const messages = await res.json();
      const ul = document.getElementById('messagesList');
      ul.innerHTML = '';
      messages.forEach(msg => {
        const li = document.createElement('li');
        li.textContent = `${msg.date} - ${msg.message}`;
        ul.appendChild(li);
      });
    }

    loadMessages();
    setInterval(loadMessages, 5000); // recharge toutes les 5 sec
  </script>
</body>
</html>
